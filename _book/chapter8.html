<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Inference | Introduction to quantitative methods for economists</title>
  <meta name="description" content="This online introductory textbook offers the essential coding and quantitative skills to students in economics and social sciences in general." />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Inference | Introduction to quantitative methods for economists" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This online introductory textbook offers the essential coding and quantitative skills to students in economics and social sciences in general." />
  <meta name="github-repo" content="Alessandro1984/Intro_to_quant_methods" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Inference | Introduction to quantitative methods for economists" />
  
  <meta name="twitter:description" content="This online introductory textbook offers the essential coding and quantitative skills to students in economics and social sciences in general." />
  

<meta name="author" content="Alessandro Bramucci" />


<meta name="date" content="2022-09-15" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="chapter7.html"/>
<link rel="next" href="chapter9.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="images/logo.png"></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About this book</a></li>
<li class="part"><span><b>I Introduction to R</b></span></li>
<li class="chapter" data-level="1" data-path="chapter1.html"><a href="chapter1.html"><i class="fa fa-check"></i><b>1</b> Language essentials</a>
<ul>
<li class="chapter" data-level="1.1" data-path="chapter1.html"><a href="chapter1.html#why-r"><i class="fa fa-check"></i><b>1.1</b> Why R?</a></li>
<li class="chapter" data-level="1.2" data-path="chapter1.html"><a href="chapter1.html#r-and-rstudio"><i class="fa fa-check"></i><b>1.2</b> R and RStudio</a></li>
<li class="chapter" data-level="1.3" data-path="chapter1.html"><a href="chapter1.html#basic-operations"><i class="fa fa-check"></i><b>1.3</b> Basic operations</a></li>
<li class="chapter" data-level="1.4" data-path="chapter1.html"><a href="chapter1.html#basic-data-structures"><i class="fa fa-check"></i><b>1.4</b> Basic data structures</a></li>
<li class="chapter" data-level="1.5" data-path="chapter1.html"><a href="chapter1.html#if-else-statement"><i class="fa fa-check"></i><b>1.5</b> if else statement</a></li>
<li class="chapter" data-level="1.6" data-path="chapter1.html"><a href="chapter1.html#for-loops"><i class="fa fa-check"></i><b>1.6</b> For loops</a></li>
<li class="chapter" data-level="1.7" data-path="chapter1.html"><a href="chapter1.html#nested-loops"><i class="fa fa-check"></i><b>1.7</b> Nested loops</a></li>
<li class="chapter" data-level="1.8" data-path="chapter1.html"><a href="chapter1.html#simple-functions"><i class="fa fa-check"></i><b>1.8</b> Simple functions</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chapter2.html"><a href="chapter2.html"><i class="fa fa-check"></i><b>2</b> Data extraction and manipulation</a>
<ul>
<li class="chapter" data-level="2.1" data-path="chapter2.html"><a href="chapter2.html#conditional-selection"><i class="fa fa-check"></i><b>2.1</b> Conditional selection</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chapter3.html"><a href="chapter3.html"><i class="fa fa-check"></i><b>3</b> Application</a>
<ul>
<li class="chapter" data-level="3.1" data-path="chapter3.html"><a href="chapter3.html#contributions-to-gdp-growth"><i class="fa fa-check"></i><b>3.1</b> Contributions to GDP growth</a></li>
<li class="chapter" data-level="3.2" data-path="chapter3.html"><a href="chapter3.html#pulling-and-filtering-data"><i class="fa fa-check"></i><b>3.2</b> Pulling and filtering data</a></li>
<li class="chapter" data-level="3.3" data-path="chapter3.html"><a href="chapter3.html#calculation-of-the-growth-contributions"><i class="fa fa-check"></i><b>3.3</b> Calculation of the growth contributions</a></li>
<li class="chapter" data-level="3.4" data-path="chapter3.html"><a href="chapter3.html#graph-of-the-growth-contributions-for-germany"><i class="fa fa-check"></i><b>3.4</b> Graph of the growth contributions for Germany</a></li>
<li class="chapter" data-level="3.5" data-path="chapter3.html"><a href="chapter3.html#average-growth-contributions"><i class="fa fa-check"></i><b>3.5</b> Average growth contributions</a></li>
</ul></li>
<li class="part"><span><b>II Review of math and statistics</b></span></li>
<li class="chapter" data-level="4" data-path="chapter4.html"><a href="chapter4.html"><i class="fa fa-check"></i><b>4</b> Basic math elements</a>
<ul>
<li class="chapter" data-level="4.1" data-path="chapter4.html"><a href="chapter4.html#derivative-rules"><i class="fa fa-check"></i><b>4.1</b> Derivative rules</a></li>
<li class="chapter" data-level="4.2" data-path="chapter4.html"><a href="chapter4.html#matrix-operations"><i class="fa fa-check"></i><b>4.2</b> Matrix operations</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chapter5.html"><a href="chapter5.html"><i class="fa fa-check"></i><b>5</b> Fundamental concepts in statistics</a>
<ul>
<li class="chapter" data-level="5.1" data-path="chapter5.html"><a href="chapter5.html#mean-and-median"><i class="fa fa-check"></i><b>5.1</b> Mean and median</a></li>
<li class="chapter" data-level="5.2" data-path="chapter5.html"><a href="chapter5.html#boxplot"><i class="fa fa-check"></i><b>5.2</b> Boxplot</a></li>
<li class="chapter" data-level="5.3" data-path="chapter5.html"><a href="chapter5.html#expected-value"><i class="fa fa-check"></i><b>5.3</b> Expected value</a></li>
<li class="chapter" data-level="5.4" data-path="chapter5.html"><a href="chapter5.html#variance"><i class="fa fa-check"></i><b>5.4</b> Variance</a></li>
<li class="chapter" data-level="5.5" data-path="chapter5.html"><a href="chapter5.html#correlation"><i class="fa fa-check"></i><b>5.5</b> Correlation</a></li>
<li class="chapter" data-level="5.6" data-path="chapter5.html"><a href="chapter5.html#covariance"><i class="fa fa-check"></i><b>5.6</b> Covariance</a></li>
<li class="chapter" data-level="5.7" data-path="chapter5.html"><a href="chapter5.html#expected-value-variance-and-covariance-rules"><i class="fa fa-check"></i><b>5.7</b> Expected value, variance and covariance rules</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chapter6.html"><a href="chapter6.html"><i class="fa fa-check"></i><b>6</b> Introduction to statistical inference</a>
<ul>
<li class="chapter" data-level="6.1" data-path="chapter6.html"><a href="chapter6.html#the-normal-distribution"><i class="fa fa-check"></i><b>6.1</b> The normal distribution</a></li>
<li class="chapter" data-level="6.2" data-path="chapter6.html"><a href="chapter6.html#the-standard-normal-distribution"><i class="fa fa-check"></i><b>6.2</b> The standard normal distribution</a></li>
</ul></li>
<li class="part"><span><b>III The linear regression</b></span></li>
<li class="chapter" data-level="7" data-path="chapter7.html"><a href="chapter7.html"><i class="fa fa-check"></i><b>7</b> Regression analysis</a>
<ul>
<li class="chapter" data-level="7.1" data-path="chapter7.html"><a href="chapter7.html#simple-regression-model"><i class="fa fa-check"></i><b>7.1</b> Simple regression model</a></li>
<li class="chapter" data-level="7.2" data-path="chapter7.html"><a href="chapter7.html#multiple-regression-model"><i class="fa fa-check"></i><b>7.2</b> Multiple regression model</a></li>
<li class="chapter" data-level="7.3" data-path="chapter7.html"><a href="chapter7.html#regression-assumptions"><i class="fa fa-check"></i><b>7.3</b> Regression assumptions</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chapter8.html"><a href="chapter8.html"><i class="fa fa-check"></i><b>8</b> Inference</a>
<ul>
<li class="chapter" data-level="8.1" data-path="chapter8.html"><a href="chapter8.html#the-basics-of-hypothesis-testing"><i class="fa fa-check"></i><b>8.1</b> The basics of hypothesis testing</a></li>
<li class="chapter" data-level="8.2" data-path="chapter8.html"><a href="chapter8.html#the-t-test-in-the-regression"><i class="fa fa-check"></i><b>8.2</b> The <em>t</em> test in the regression</a></li>
<li class="chapter" data-level="8.3" data-path="chapter8.html"><a href="chapter8.html#f-statistic-for-overall-significance-of-a-regression"><i class="fa fa-check"></i><b>8.3</b> F statistic for overall significance of a regression</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chapter9.html"><a href="chapter9.html"><i class="fa fa-check"></i><b>9</b> Applications</a>
<ul>
<li class="chapter" data-level="9.1" data-path="chapter9.html"><a href="chapter9.html#linear-growth-model"><i class="fa fa-check"></i><b>9.1</b> Linear growth model</a></li>
<li class="chapter" data-level="9.2" data-path="chapter9.html"><a href="chapter9.html#the-consumption-function"><i class="fa fa-check"></i><b>9.2</b> The consumption function</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/Alessandro1984/Intro_to_quant_methods" target="blank">GitHub repository</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to quantitative methods for economists</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<link href="style.css" rel="stylesheet">
<div class="hero-image-container"> 
  <img class= "hero-image" src="images/fotohero.jpg">
</div>
<div id="chapter8" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">Chapter 8</span> Inference<a href="chapter8.html#chapter8" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="the-basics-of-hypothesis-testing" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> The basics of hypothesis testing<a href="#fn37" class="footnote-ref" id="fnref37"><sup>37</sup></a><a href="chapter8.html#the-basics-of-hypothesis-testing" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In <strong>descriptive statistics</strong>, we work with a sample of data obtained from a larger population and we are interested in understanding the characteristics of the sample. In <strong>inferential statistics</strong>, we use the sample to try to obtain conclusions (more precisely said, to make inference) regarding the characteristics of the population from which the sample is obtained. For example, having a sample available we might be interested in inferring whether the sample mean (sample statistics, <span class="math inline">\(\bar{x}\)</span>) is representative of the population mean (population parameter, <span class="math inline">\(\mu\)</span>). That is, we are interested in generalising the information obtained from the sample to the entire population. Of course it is easy to imagine that our conclusion will be subject to error as we only have one sample available. With only one sample available, it is very unlikely that the sample mean will be identical to the population mean. So in our inference process we have to take this sampling error into account.</p>
<p>Hypothesis testing is a widely used statistical procedure for making inference from a sample to a population.<a href="#fn38" class="footnote-ref" id="fnref38"><sup>38</sup></a> The test starts with two statements. The <strong>null hypothesis</strong>, denoted <span class="math inline">\(H_0\)</span>. The null hypothesis describes the condition that is assumed to be true at the time. It is often compared to the situation in court where an accused person is assumed to be innocent until there is enough evidence to find him guilty. The second statement is the <strong>alternative hypothesis</strong>, denote <span class="math inline">\(H_1\)</span>. The null hypothesis and the alternative hypothesis are mutually exclusive. The alternative hypothesis is the one that is favoured if enough evidence is found. Many times we have a theory that suggests which values to specify for the null hypothesis and the alternative hypothesis. Hypothesis testing is a means of testing the statistical (not practical) validity of our theory.</p>
<p><span class="math display">\[H_0: \mu = \mu_0\]</span></p>
<p><span class="math display">\[H_1: \mu \neq \mu_0\]</span></p>
<p>How do we decide between the null hypothesis and the alternative hypothesis? We assume that we have a normally distributed random variable <span class="math inline">\(X\)</span> with mean <span class="math inline">\(\mu\)</span> and standard deviation <span class="math inline">\(\sigma\)</span>. Let us further assume that the population mean <span class="math inline">\(\mu\)</span> (which we do not know) is a value equal to <span class="math inline">\(\mu_0\)</span> (maybe because theory or experience tells us so). In a first sample obtained from our random variable <span class="math inline">\(X\)</span>, we compute the mean (<span class="math inline">\(\bar{x}\)</span>) and obtain a value close to the hypothesized value <span class="math inline">\(\mu_0\)</span>. Since we know that data are obtained from a normally distributed <span class="math inline">\(X\)</span>, we know that the probability of obtaining a value close to the mean is actually quite high. In a second sample, a much larger value of <span class="math inline">\(\bar{x}\)</span> is obtained. In this case, we know that obtaining values much larger than the mean is less probable (in other words, we are in the tales of the distribution). What should we conclude with such a high value now? Does the sample results confirm or contradict the null hypothesis, i.e. the hypothesized value for the mean of the population? We can continue to believe that the null hypothesis is correct and that we have just an unlucky sample from which we have obtained a very high mean but we are somehow convinced that the hypothesized value is still correct (<span class="math inline">\(H_0: \mu = \mu_0\)</span>) and the sample was just a bit off. Or we can convince ourselves that the sample result contradicts the assumed value <span class="math inline">\(\mu_0\)</span> and that we were wrong with the null hypothesis (therefore, <span class="math inline">\(H_1: \mu \neq \mu_0\)</span>). In the rule, the null hypothesis is rejected if the probability of obtaining such an extreme value is smaller than an arbitrarily defined probability.</p>
<p>There are two kinds of mistakes that can be made. A <strong>Type I error</strong> and a <strong>Type II error</strong>. When we reject a hypothesis that is actually true, we are committing a Type I error. When we are not rejecting (or “accepting”, but this is not the right terminology) a hypothesis that should be rejected, we are committing a Type II error. Since we are basing our decision on a sample, and there is always uncertainty in the sampling process, we are more or less sure that there is some uncertainty attached to our test conclusion. In hypothesis testing we decide in advance what kind of error we want to make. The procedure is to decide in advance to commit to a certain Type I error, e.g. we decide in advance to tolerate a Type I error in 5% of the cases. This value is called <strong>significance level</strong> and is traditionally indicated with the greek letter <span class="math inline">\(\alpha\)</span>.<a href="#fn39" class="footnote-ref" id="fnref39"><sup>39</sup></a></p>
<p><strong>Example</strong></p>
<p>The mean lifetime of a sample of 100 light bulbs is computed to be 1570 hours with a standard deviation of 120 hours. If <span class="math inline">\(\mu\)</span> is the mean lifetime of all the light bulbs produced, test the hypothesis that the population mean is <span class="math inline">\(\mu = 1600\)</span> hours against the alternative that <span class="math inline">\(\mu \neq 1600\)</span> using a significance level of 5%. Find the p-value of the test and build a 95% confidence interval.</p>
<p><span class="math display">\[H_0: \mu = 1600\]</span></p>
<p><span class="math display">\[H_1: \mu \neq \space 1600\]</span></p>
<p>We need to construct our test statistic to perform the test. In practice, wee need to transform the computed mean obtained from the sample of light bulbs into a statistic that follow a standard normal distribution with zero mean and unit variance.</p>
<p><span class="math display">\[z_{test} = \frac{\bar{x} - \mu}{\frac{\sigma}{\sqrt{n}}} = \frac{1570 - 1600}{12} = -2.5\]</span></p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="chapter8.html#cb233-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb233-2"><a href="chapter8.html#cb233-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-3"><a href="chapter8.html#cb233-3" aria-hidden="true" tabindex="-1"></a>sample_mean <span class="ot">&lt;-</span> <span class="dv">1570</span></span>
<span id="cb233-4"><a href="chapter8.html#cb233-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-5"><a href="chapter8.html#cb233-5" aria-hidden="true" tabindex="-1"></a>sample_sigma <span class="ot">&lt;-</span> <span class="dv">120</span></span>
<span id="cb233-6"><a href="chapter8.html#cb233-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb233-7"><a href="chapter8.html#cb233-7" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">1600</span></span>
<span id="cb233-8"><a href="chapter8.html#cb233-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-9"><a href="chapter8.html#cb233-9" aria-hidden="true" tabindex="-1"></a>alpha5p <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb233-10"><a href="chapter8.html#cb233-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-11"><a href="chapter8.html#cb233-11" aria-hidden="true" tabindex="-1"></a>z_test <span class="ot">&lt;-</span> <span class="fu">abs</span>((sample_mean <span class="sc">-</span> mu) <span class="sc">/</span> (sample_sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n)))</span>
<span id="cb233-12"><a href="chapter8.html#cb233-12" aria-hidden="true" tabindex="-1"></a>z_test</span></code></pre></div>
<pre><code>## [1] 2.5</code></pre>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="chapter8.html#cb235-1" aria-hidden="true" tabindex="-1"></a>z_crit_5p <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(alpha5p<span class="sc">/</span><span class="dv">2</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>Since in this exercise we are interested in performing a two-sided test (look a the formulation of the null and alternative hypothesis), we take the absolute value of our <span class="math inline">\(z\)</span> test. We can reject <span class="math inline">\(H_0\)</span> at the 5% significance level (<span class="math inline">\(\alpha\)</span> = 5%) if,</p>
<p><span class="math display">\[|z_{test}| &gt; z_{crit}\]</span></p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="chapter8.html#cb236-1" aria-hidden="true" tabindex="-1"></a>z_test <span class="sc">&gt;</span> z_crit_5p</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>We can reject <span class="math inline">\(H_0\)</span> at the 5% significance level. In the following graph, in green we can see the rejection region (the two green shaded areas add up to 5%) while with the yellow line it is indicated the value of our <span class="math inline">\(z\)</span> test in both tails of the distribution. As we said, since the value of our <span class="math inline">\(z\)</span> test falls within the rejection region, we can reject <span class="math inline">\(H_0\)</span> at the 5% significance level.</p>
<p><img src="Intro_to_quant_methods_files/figure-html/unnamed-chunk-116-1.png" width="70%" height="30%" style="display: block; margin: auto;" /></p>
<p>What do we see highlighted in black in the graph above? The sum of the two black areas represent our p-value for the <em>z</em> score that we have just calculated. We can think of the p-value as the smallest significance level at which we still reject the null hypothesis (or the largest significance level at which the null hypothesis cannot be rejected). How large is the p-value for our <em>z</em> test?</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="chapter8.html#cb238-1" aria-hidden="true" tabindex="-1"></a>pvalue <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(z_test, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>) <span class="sc">*</span> <span class="dv">2</span></span>
<span id="cb238-2"><a href="chapter8.html#cb238-2" aria-hidden="true" tabindex="-1"></a>pvalue<span class="sc">*</span><span class="dv">100</span></span></code></pre></div>
<pre><code>## [1] 1.241933</code></pre>
<p>How can we interpret the p-value? In our exercise, the p-value of 1.24% represents the probability that a mean lifetime of less than 1570 or more than 1630 hours would occur by chance if <span class="math inline">\(H_0\)</span> were actually true. A rather small probability. How did we obtain the values 1570 and 1630? We have used (half) of the p-value to calculate the quantiles of a normal distribution with mean <span class="math inline">\(mu = 1600\)</span> and standard deviation <span class="math inline">\(120/\sqrt{100}\)</span>.</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="chapter8.html#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(pvalue<span class="sc">/</span><span class="dv">2</span>, <span class="at">mean =</span> mu, <span class="at">sd =</span> (sample_sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n)), <span class="at">lower.tail =</span> <span class="cn">FALSE</span>) </span></code></pre></div>
<pre><code>## [1] 1630</code></pre>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="chapter8.html#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(pvalue<span class="sc">/</span><span class="dv">2</span>, <span class="at">mean =</span> mu, <span class="at">sd =</span> (sample_sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n)), <span class="at">lower.tail =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] 1570</code></pre>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="chapter8.html#cb244-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">pnorm</span>(<span class="dv">1570</span>, <span class="at">mean =</span> mu, <span class="at">sd =</span> (sample_sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n)), <span class="at">lower.tail =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> </span>
<span id="cb244-2"><a href="chapter8.html#cb244-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="dv">1630</span>, <span class="at">mean =</span> mu, <span class="at">sd =</span> (sample_sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n)), <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)) <span class="sc">*</span> <span class="dv">100</span></span></code></pre></div>
<pre><code>## [1] 1.241933</code></pre>
<p>Since we see that the p-value is larger than 1%, we already know that we will fail to reject the null hypothesis at the 1% significance level (<span class="math inline">\(\alpha\)</span> = 1%) . Shouldn’t we have used a <em>t</em> test rather than a <span class="math inline">\(z\)</span> test as suggested by professional statisticians? Probably yes. Since we do not know the population standard deviation (the standard deviation of all light bulbs), a <em>t</em> test sounds more appropriate. However, since our sample is relatively large (<span class="math inline">\(n = 100\)</span>), much larger than the commonly suggested rule of thumb (<span class="math inline">\(n &gt; 30\)</span>), we will practically obtain (almost) the same result using the normal distribution and the <em>t</em> distribution.<a href="#fn40" class="footnote-ref" id="fnref40"><sup>40</sup></a> To conclude, we need to construct the 95% confidence interval (<span class="math inline">\(100 - \alpha\)</span>, where <span class="math inline">\(\alpha\)</span> = 5%).</p>
<p><span class="math display">\[(\bar{x} + z_{\alpha / 2} \cdot \frac{\sigma}{\sqrt{n}}; \bar{x} + z_{1 - \alpha / 2} \cdot \frac{\sigma}{\sqrt{n}})\]</span></p>
<p>We must be careful with the signs in the formula above. Once we look up the critical value <span class="math inline">\(z_{\alpha / 2}\)</span> (or we compute it using R) we will see that the quantity is actually negative. If we include the negative sign in the formula for the confidence interval, it would not be wrong, but it can create some confusion. This is why it is better to use the formula below. In this case, we have to include the negative sign in the formula because <span class="math inline">\(z_{1 - \alpha / 2}\)</span> is going to be a positive number and this is the version that we are going to implement in R.</p>
<p><span class="math display">\[(\bar{x} - z_{1 - \alpha / 2} \cdot \frac{\sigma}{\sqrt{n}}; \bar{x} + z_{1 - \alpha / 2} \cdot \frac{\sigma}{\sqrt{n}})\]</span></p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="chapter8.html#cb246-1" aria-hidden="true" tabindex="-1"></a>sample_mean <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="sc">+</span><span class="dv">1</span>) <span class="sc">*</span> z_crit_5p <span class="sc">*</span> (sample_sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n)) </span></code></pre></div>
<pre><code>## [1] 1546.48 1593.52</code></pre>
<p>The hypothesized value for the mean lifetime of all the bulbs produced was 1600 working hours. Since this particular value falls outside the confidence interval constructed around the sample mean, we can reject <span class="math inline">\(H_0\)</span>. With the confidence interval test the null hypothesis is rejected if and only if the hypothesized value falls outside the confidence interval. The <span class="math inline">\(z\)</span> test (or <span class="math inline">\(t\)</span> test) and the confidence interval test are basically an elaboration of one another and provides always the same test decision.<a href="#fn41" class="footnote-ref" id="fnref41"><sup>41</sup></a></p>
</div>
<div id="the-t-test-in-the-regression" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> The <em>t</em> test in the regression<a href="chapter8.html#the-t-test-in-the-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We are now going to perform the test of the hypothesis on the population parameters of a simple bivariate linear regression model. The good news is that this procedure is done automatically by all statistical packages that run regressions. In our case, we are going to replicate the results provided with the output of the <span class="math inline">\(lm\)</span> function in R.</p>
<table style="text-align:center">
<caption>
<strong>wage = + educ + u</strong>
</caption>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="1" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
wage
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
educ
</td>
<td>
0.541<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.053)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
-0.905
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.685)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
526
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.165
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td style="text-align:right">
<sup><em></sup>p&lt;0.1; <sup><strong></sup>p&lt;0.05; <sup></strong></em></sup>p&lt;0.01
</td>
</tr>
</table>
<p>First, we perform a two-sided <em>t</em> test for the intercept parameter (<span class="math inline">\(\beta_0\)</span>). We want to test the null hypothesis (<span class="math inline">\(H_0\)</span>) that <span class="math inline">\(\beta_0 = 0\)</span> against the alternative hypothesis (<span class="math inline">\(H_1\)</span>) that <span class="math inline">\(\beta_0 \neq 0\)</span>. This is the kind of hypothesis test that is usually performed by linear regression function in software packages. Since we are interested in a two-sided test, we will take the absolute value of our <span class="math inline">\(t\)</span> statistic. We want to perform the test at the 5% significance level. We need to find the critical value for a 5% significance level with 524 degrees of freedom. We reject <span class="math inline">\(H_0\)</span> if <span class="math inline">\(|t_{\hat{\beta}_0}| &gt; t_{crit}\)</span> otherwise we will fail to reject <span class="math inline">\(H_0\)</span>.</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="chapter8.html#cb248-1" aria-hidden="true" tabindex="-1"></a>alpha5p <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb248-2"><a href="chapter8.html#cb248-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb248-3"><a href="chapter8.html#cb248-3" aria-hidden="true" tabindex="-1"></a>t_stat_beta_0 <span class="ot">&lt;-</span> <span class="fu">abs</span>(sum_reg1<span class="sc">$</span>coefficients[<span class="dv">1</span>,<span class="dv">3</span>])</span>
<span id="cb248-4"><a href="chapter8.html#cb248-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb248-5"><a href="chapter8.html#cb248-5" aria-hidden="true" tabindex="-1"></a>t_crit_5p <span class="ot">&lt;-</span> <span class="fu">qt</span>(alpha5p<span class="sc">/</span><span class="dv">2</span>, <span class="at">df =</span> reg1<span class="sc">$</span>df.residual, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb248-6"><a href="chapter8.html#cb248-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb248-7"><a href="chapter8.html#cb248-7" aria-hidden="true" tabindex="-1"></a>t_stat_beta_0 <span class="sc">&gt;</span> t_crit_5p</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<p>We fail to reject <span class="math inline">\(H_0\)</span> at the 5% significance level. Consequently, we will fail to reject the <span class="math inline">\(H_0\)</span> for every significance level smaller than 5%. Which one is the smallest significance level at which we still reject <span class="math inline">\(H_0\)</span>? We need to calculate the (in)famous p-value. In this case, it is given by <span class="math inline">\(P(|T| &gt; |t_{\hat{\beta}_0}|)\)</span>.<a href="#fn42" class="footnote-ref" id="fnref42"><sup>42</sup></a> We can use the function <em>pt</em> to calculate the area below the <em>t</em> distribution at the right of our <span class="math inline">\(t_{\hat{\beta}_0}\)</span>. Don’t forget to multiply this quantity by two as we need the p-value for a two-sided test.</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="chapter8.html#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pt</span>(t_stat_beta_0, <span class="at">df =</span> reg1<span class="sc">$</span>df.residual, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>) <span class="sc">*</span> <span class="dv">2</span> <span class="sc">*</span> <span class="dv">100</span></span></code></pre></div>
<pre><code>## [1] 18.70735</code></pre>
<p>We have a relatively large sample. We know that the <em>t</em> distribution converges to the standard normal distribution as the number of observation in the sample approaches infinity (meaning that the quantiles of the <em>t</em> distribution and the standard normal distribution are the same). Therefore, we can obtain (almost) the same result using the function <em>pnorm</em>.</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="chapter8.html#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(t_stat_beta_0, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>) <span class="sc">*</span> <span class="dv">2</span> <span class="sc">*</span> <span class="dv">100</span></span></code></pre></div>
<pre><code>## [1] 18.64969</code></pre>
<p>We can check that we will actually reject <span class="math inline">\(H_0\)</span> for a significance level larger than our p-value. Let’s try to see what’s happening when the significance level is 20%.<a href="#fn43" class="footnote-ref" id="fnref43"><sup>43</sup></a> As before, we reject <span class="math inline">\(H_0\)</span> if <span class="math inline">\(|t_{\hat{\beta}_0}| &gt; t_{crit}\)</span> otherwise we will fail to reject <span class="math inline">\(H_0\)</span>.</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="chapter8.html#cb254-1" aria-hidden="true" tabindex="-1"></a>alpha20p <span class="ot">&lt;-</span> <span class="fl">0.20</span></span>
<span id="cb254-2"><a href="chapter8.html#cb254-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-3"><a href="chapter8.html#cb254-3" aria-hidden="true" tabindex="-1"></a>t_crit_20p <span class="ot">&lt;-</span> <span class="fu">qt</span>(alpha20p<span class="sc">/</span><span class="dv">2</span>, <span class="at">df =</span> reg1<span class="sc">$</span>df.residual, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb254-4"><a href="chapter8.html#cb254-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-5"><a href="chapter8.html#cb254-5" aria-hidden="true" tabindex="-1"></a>t_stat_beta_0 <span class="sc">&gt;</span> t_crit_20p</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>Given the result of the test, we reject <span class="math inline">\(H_0\)</span> at the 20% significance level. We can also build a 95% confidence interval for the intercept:<a href="#fn44" class="footnote-ref" id="fnref44"><sup>44</sup></a></p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="chapter8.html#cb256-1" aria-hidden="true" tabindex="-1"></a>beta_0 <span class="ot">&lt;-</span> sum_reg1<span class="sc">$</span>coefficients[<span class="dv">1</span>,<span class="dv">1</span>]</span>
<span id="cb256-2"><a href="chapter8.html#cb256-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-3"><a href="chapter8.html#cb256-3" aria-hidden="true" tabindex="-1"></a>se_beta_0 <span class="ot">&lt;-</span> sum_reg1<span class="sc">$</span>coefficients[<span class="dv">1</span>,<span class="dv">2</span>]</span>
<span id="cb256-4"><a href="chapter8.html#cb256-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-5"><a href="chapter8.html#cb256-5" aria-hidden="true" tabindex="-1"></a>ci_lower <span class="ot">&lt;-</span> beta_0 <span class="sc">-</span> t_crit_5p <span class="sc">*</span> se_beta_0</span>
<span id="cb256-6"><a href="chapter8.html#cb256-6" aria-hidden="true" tabindex="-1"></a>ci_lower</span></code></pre></div>
<pre><code>## [1] -2.250472</code></pre>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="chapter8.html#cb258-1" aria-hidden="true" tabindex="-1"></a>ci_upper <span class="ot">&lt;-</span> beta_0 <span class="sc">+</span> t_crit_5p <span class="sc">*</span> se_beta_0</span>
<span id="cb258-2"><a href="chapter8.html#cb258-2" aria-hidden="true" tabindex="-1"></a>ci_upper</span></code></pre></div>
<pre><code>## [1] 0.4407687</code></pre>
<p>Since the value of 0 is contained in the confidence interval, we fail to reject <span class="math inline">\(H_0\)</span> at 5% significance level. The <span class="math inline">\(H_0\)</span> is rejected if and only if the value 0 is not contained in the 95% confidence interval. There is no need to repeat all these steps above every time. The <em>confint</em> function allows us to quickly calculate the confidence interval.</p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="chapter8.html#cb260-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(reg1, <span class="at">parm =</span> <span class="dv">1</span>, <span class="at">level =</span> <span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>##                 2.5 %    97.5 %
## (Intercept) -2.250472 0.4407687</code></pre>
<p>Now, we perform a two-sided <em>t</em> test for the slope parameter. We want to test the null hypothesis (<span class="math inline">\(H_0\)</span>) that <span class="math inline">\(\beta_1 = 0\)</span> against the alternative hypothesis (<span class="math inline">\(H_1\)</span>) <span class="math inline">\(\beta_1 \neq 0\)</span>. Since we are interested in a two-sided test, we will take the absolute value of our <em>t</em> statistic. As we know, we reject <span class="math inline">\(H_0\)</span> if <span class="math inline">\(|t_{\hat{\beta}_1}| &gt; t_{crit}\)</span>, otherwise, we fail to reject <span class="math inline">\(H_0\)</span>.</p>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="chapter8.html#cb262-1" aria-hidden="true" tabindex="-1"></a>t_stat_beta_1 <span class="ot">&lt;-</span> <span class="fu">abs</span>(sum_reg1<span class="sc">$</span>coefficients[<span class="dv">2</span>,<span class="dv">3</span>])</span>
<span id="cb262-2"><a href="chapter8.html#cb262-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-3"><a href="chapter8.html#cb262-3" aria-hidden="true" tabindex="-1"></a>t_stat_beta_1 <span class="sc">&gt;</span> t_crit_5p</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>What is the conclusion of the test? We can reject <span class="math inline">\(H_0\)</span> that <span class="math inline">\(\beta_1 = 0\)</span> at the 5% significance level. Can we reject <span class="math inline">\(H_0\)</span> also at the 1% significance level? We must first calculate the critical value for a 1% significance level with 524 degrees of freedom.</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="chapter8.html#cb264-1" aria-hidden="true" tabindex="-1"></a>alpha1p <span class="ot">&lt;-</span> <span class="fl">0.01</span></span>
<span id="cb264-2"><a href="chapter8.html#cb264-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-3"><a href="chapter8.html#cb264-3" aria-hidden="true" tabindex="-1"></a>t_crit_1p <span class="ot">&lt;-</span> <span class="fu">qt</span>(alpha1p<span class="sc">/</span><span class="dv">2</span>, <span class="at">df =</span> reg1<span class="sc">$</span>df.residual, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb264-4"><a href="chapter8.html#cb264-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-5"><a href="chapter8.html#cb264-5" aria-hidden="true" tabindex="-1"></a>t_stat_beta_1 <span class="sc">&gt;</span> t_crit_1p</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>We can reject <span class="math inline">\(H_0\)</span> that <span class="math inline">\(\beta_1 = 0\)</span> also at the 1% significance level. We can also build a 95% confidence interval for the slope parameter.</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="chapter8.html#cb266-1" aria-hidden="true" tabindex="-1"></a>beta_1 <span class="ot">&lt;-</span> sum_reg1<span class="sc">$</span>coefficients[<span class="dv">2</span>,<span class="dv">1</span>]</span>
<span id="cb266-2"><a href="chapter8.html#cb266-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-3"><a href="chapter8.html#cb266-3" aria-hidden="true" tabindex="-1"></a>se_beta_1 <span class="ot">&lt;-</span> sum_reg1<span class="sc">$</span>coefficients[<span class="dv">2</span>,<span class="dv">2</span>]</span>
<span id="cb266-4"><a href="chapter8.html#cb266-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-5"><a href="chapter8.html#cb266-5" aria-hidden="true" tabindex="-1"></a>ci_lower <span class="ot">&lt;-</span> beta_1 <span class="sc">-</span> t_crit_5p <span class="sc">*</span> se_beta_1</span>
<span id="cb266-6"><a href="chapter8.html#cb266-6" aria-hidden="true" tabindex="-1"></a>ci_lower</span></code></pre></div>
<pre><code>## [1] 0.4367534</code></pre>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="chapter8.html#cb268-1" aria-hidden="true" tabindex="-1"></a>ci_upper <span class="ot">&lt;-</span> beta_1 <span class="sc">+</span> t_crit_5p <span class="sc">*</span> se_beta_1</span>
<span id="cb268-2"><a href="chapter8.html#cb268-2" aria-hidden="true" tabindex="-1"></a>ci_upper</span></code></pre></div>
<pre><code>## [1] 0.6459651</code></pre>
<p>Since the value of 0 is not contained in the confidence interval, we reject <span class="math inline">\(H_0\)</span> at 5% significance level. Also here we can check our result using the <em>confint</em> function.</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="chapter8.html#cb270-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(reg1, <span class="at">parm =</span> <span class="dv">2</span>, <span class="at">level =</span> <span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>##          2.5 %    97.5 %
## educ 0.4367534 0.6459651</code></pre>
</div>
<div id="f-statistic-for-overall-significance-of-a-regression" class="section level2 hasAnchor" number="8.3">
<h2><span class="header-section-number">8.3</span> F statistic for overall significance of a regression<a href="chapter8.html#f-statistic-for-overall-significance-of-a-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <em>F</em> test is used to test whether a group of variables has no effect on the dependent variable. In this sense, the test allows to test if the parameters of a set (or at the limit all) the independent variables are <strong>jointly significance</strong>. Obviously it is the theory or intuition that tells us to operate such a test on a given group of variables. It is often the case that the <em>F</em> test is performed on all independent variables in a model. It is then said that the test is for the overall significance of the regression. In this exercise, to understand how the <em>F</em> test works in practice, we will replicate the <em>F</em> test provided by the regression function in R (as by any other statistical software packages). This is precisely a test for overall joint significance of the regression. We estimate the following model:</p>
<p><span class="math display">\[wage = \beta_0 + \beta_1educ + \beta_2exper + \beta_3tenure + u\]</span></p>
<p>We formulate the following joint null hypothesis (<span class="math inline">\(H_0\)</span>) stating that the regressors have jointly no effect on the dependent variable:</p>
<p><span class="math display">\[H_0 : \beta_1 = \beta_2 = \beta_3 = 0\]</span></p>
<p>The alternative hypothesis (<span class="math inline">\(H_1\)</span>) is:</p>
<p><span class="math display">\[H_1 : H_0 \space \text{is not true}\]</span></p>
<p>The formula for the <em>F</em> statistic (or <em>F</em> ratio), where <span class="math inline">\(q\)</span> is the number of restrictions (in this example we are imposing three restrictions), and <span class="math inline">\(n-k-1\)</span> is the number of degrees of freedom of the unrestricted model, is defined by:<a href="#fn45" class="footnote-ref" id="fnref45"><sup>45</sup></a></p>
<p><span class="math display">\[F = \frac{SSR_r - SSR_{ur}}{SSR_{ur}} * \frac{(n-k-1)}{q}\]</span></p>
<p>First, we estimate the <em>unrestricted</em> model. With this term, we mean the entire or complete model:</p>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="chapter8.html#cb272-1" aria-hidden="true" tabindex="-1"></a>reg1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(wage1<span class="sc">$</span>wage <span class="sc">~</span> wage1<span class="sc">$</span>educ <span class="sc">+</span> wage1<span class="sc">$</span>exper <span class="sc">+</span> wage1<span class="sc">$</span>tenure)</span></code></pre></div>
<p>We can now calculate the sum of squared residual (SSR) of the unrestricted model:</p>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="chapter8.html#cb273-1" aria-hidden="true" tabindex="-1"></a>SSR_ur <span class="ot">&lt;-</span> <span class="fu">sum</span>(reg1<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<p>We then estimate the <em>restricted</em> model. The restricted model has clearly less parameters than the unrestricted model. Since we are performing an <em>F</em> test for the overall significance of the regression, we must regress the dependent variable <em>wage</em> on just an intercept. In R, this is done by including only a “1” after the <em>tilde</em> sign in the <em>lm</em> function.</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="chapter8.html#cb274-1" aria-hidden="true" tabindex="-1"></a>reg2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(wage1<span class="sc">$</span>wage <span class="sc">~</span> <span class="dv">1</span>)</span></code></pre></div>
<p>We can now calculate the SSR of the restricted model.</p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="chapter8.html#cb275-1" aria-hidden="true" tabindex="-1"></a>SSR_r <span class="ot">&lt;-</span> <span class="fu">sum</span>(reg2<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<p>We report the results in a single table created using the <em>stargazer</em> package.</p>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="chapter8.html#cb276-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(reg1, reg2, </span>
<span id="cb276-2"><a href="chapter8.html#cb276-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">type =</span> <span class="st">&quot;html&quot;</span>,</span>
<span id="cb276-3"><a href="chapter8.html#cb276-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">header =</span> <span class="cn">FALSE</span>,</span>
<span id="cb276-4"><a href="chapter8.html#cb276-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">&quot;F test for the overall significance of the regression.&quot;</span>,</span>
<span id="cb276-5"><a href="chapter8.html#cb276-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">keep.stat =</span> <span class="fu">c</span>(<span class="st">&quot;n&quot;</span>, <span class="st">&quot;rsq&quot;</span>, <span class="st">&quot;f&quot;</span>))</span></code></pre></div>
<table style="text-align:center">
<caption>
<strong>F test for the overall significance of the regression.</strong>
</caption>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="2">
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="2">
wage
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(1)
</td>
<td>
(2)
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
educ
</td>
<td>
0.599<sup>***</sup>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.051)
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
exper
</td>
<td>
0.022<sup>*</sup>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.012)
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
tenure
</td>
<td>
0.169<sup>***</sup>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.022)
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
-2.873<sup>***</sup>
</td>
<td>
5.896<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.729)
</td>
<td>
(0.161)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
526
</td>
<td>
526
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.306
</td>
<td>
0.000
</td>
</tr>
<tr>
<td style="text-align:left">
F Statistic
</td>
<td>
76.873<sup>***</sup> (df = 3; 522)
</td>
<td>
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td colspan="2" style="text-align:right">
<sup><em></sup>p&lt;0.1; <sup><strong></sup>p&lt;0.05; <sup></strong></em></sup>p&lt;0.01
</td>
</tr>
</table>
<p>Finally, we can calculate the <em>F</em> statistic and its corresponding p-value. We compare the value of our <em>F</em> statistic (and its p-value) with the value provided by R (see the last row of the first column in the table above).</p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="chapter8.html#cb277-1" aria-hidden="true" tabindex="-1"></a>df_ur <span class="ot">&lt;-</span> reg1<span class="sc">$</span>df.residual <span class="co"># 522</span></span>
<span id="cb277-2"><a href="chapter8.html#cb277-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb277-3"><a href="chapter8.html#cb277-3" aria-hidden="true" tabindex="-1"></a>df_r <span class="ot">&lt;-</span> reg2<span class="sc">$</span>df.residual <span class="co"># 525</span></span>
<span id="cb277-4"><a href="chapter8.html#cb277-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb277-5"><a href="chapter8.html#cb277-5" aria-hidden="true" tabindex="-1"></a>q <span class="ot">&lt;-</span> df_r <span class="sc">-</span> df_ur <span class="co"># 3</span></span>
<span id="cb277-6"><a href="chapter8.html#cb277-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb277-7"><a href="chapter8.html#cb277-7" aria-hidden="true" tabindex="-1"></a>F_test <span class="ot">&lt;-</span> (SSR_r <span class="sc">-</span> SSR_ur) <span class="sc">/</span> SSR_ur <span class="sc">*</span> df_ur <span class="sc">/</span> q</span>
<span id="cb277-8"><a href="chapter8.html#cb277-8" aria-hidden="true" tabindex="-1"></a>F_test</span></code></pre></div>
<pre><code>## [1] 76.87317</code></pre>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="chapter8.html#cb279-1" aria-hidden="true" tabindex="-1"></a>pval <span class="ot">&lt;-</span> <span class="fu">pf</span>(F_test, q, df_ur, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb279-2"><a href="chapter8.html#cb279-2" aria-hidden="true" tabindex="-1"></a>pval</span></code></pre></div>
<pre><code>## [1] 3.405862e-41</code></pre>
<p>We choose a significance level (<span class="math inline">\(\alpha\)</span>) of 1% and calculate the corresponding critical value in the <em>F</em> distribution.</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="chapter8.html#cb281-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qf</span>(<span class="fl">0.01</span>, <span class="at">df =</span> <span class="dv">3</span>, <span class="at">df2 =</span> <span class="dv">522</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## [1] 3.819327</code></pre>
<p>What is the conclusion of the test? We can observe that our <em>F</em> value is clearly larger the critical value for the chosen significance level of 1%. Our p-value is also very very small, certainly smaller than the significance level of 1%. We can therefore soundly reject the null hypothesis that the variables are not jointly significant. We can also create the graph of the <em>F</em> distribution. In green we mark the rejection region for the significance level that we have choosen.</p>
<p><img src="Intro_to_quant_methods_files/figure-html/unnamed-chunk-138-1.png" width="70%" height="30%" style="display: block; margin: auto;" /></p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="37">
<li id="fn37"><p>The discussion presented here is based on Wooldridge, J. Introductory Econometrics: A Modern Approach (Chapter 4 and Appendix C) and Dougherty, C. Introduction to Econometrics (Review chapter).<a href="chapter8.html#fnref37" class="footnote-back">↩︎</a></p></li>
<li id="fn38"><p>This procedure is part of the branch of statistics called <em>parametric statistics</em>. In fact, it is assumed that the population from which the sample is obtained follows some kind of distribution (<span class="math inline">\(t\)</span> distribution, normal distribution, <span class="math inline">\(F\)</span> distribution) to which reference will be made to compare the plausibility of the sample statistics. Another branch of statistics is called <em>non-parametric</em> and does not assume any kind of distribution.<a href="chapter8.html#fnref38" class="footnote-back">↩︎</a></p></li>
<li id="fn39"><p>Again, <span class="math inline">\(\alpha\)</span> is the probability of rejecting a true null hypothesis. Traditionally in econometrics, we use three levels of significance 10%, 5% and 1%.<a href="chapter8.html#fnref39" class="footnote-back">↩︎</a></p></li>
<li id="fn40"><p>
If we want to see why this is the case, take a look <a href="https://rpsychologist.com/d3/tdist/">here</a>.<a href="chapter8.html#fnref40" class="footnote-back">↩︎</a></p></li>
<li id="fn41"><p>
For common misunderstandings about the confidence interval, see <a href="https://en.wikipedia.org/wiki/Confidence_interval">here</a>.<a href="chapter8.html#fnref41" class="footnote-back">↩︎</a></p></li>
<li id="fn42"><p>See Wooldridge p. 126.<a href="chapter8.html#fnref42" class="footnote-back">↩︎</a></p></li>
<li id="fn43"><p>Such a large significance level is never used in practice!<a href="chapter8.html#fnref43" class="footnote-back">↩︎</a></p></li>
<li id="fn44"><p>See Wooldridge p. 130.<a href="chapter8.html#fnref44" class="footnote-back">↩︎</a></p></li>
<li id="fn45"><p>The number of degrees of freedom of the unrestricted model is given by <span class="math inline">\(n-k-1\)</span> where <span class="math inline">\(n\)</span> is the number of observations, <span class="math inline">\(k\)</span> is the number of independent variables and <span class="math inline">\(1\)</span> stands for the coefficient of the intercept.<a href="chapter8.html#fnref45" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chapter7.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chapter9.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Intro_to_quant_methods.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
